{% extends "layout/intranet/template_usu.twig" %}

{% block head %}
	<style type="text/css">

.tabs .tab a:hover, .tabs .tab a.active {
    background-color: #f4f4f4;
}
.tabs .tab.disabled a, .tabs .tab.disabled a:hover {
    color: #0d0d0d;
}
	</style>

<link type="text/css" rel="stylesheet" href="{{base_url('public/intranet/css/jquery-confirm.min.css')}}"  media="screen,projection"/>
<link type="text/css" rel="stylesheet" href="{{base_url('public/intranet/css/please-wait.css')}}"  media="screen,projection"/>
<link type="text/css" rel="stylesheet" href="{{base_url('public/intranet/css/spinkit.css')}}"  media="screen,projection"/>
{% endblock %}

{% block content %}
    <!-- Page Layout here -->
    <main class="container">
      <div class="card">
          <div class="card-content">
            <span class="card-title">¿Qué paso con tu compra?</span>
			{% if reportado %}
				<ul class="collection with-header">
			        <li class="collection-header"><h4><i class="material-icons right">report_problem</i> Reportado</span>YA REPORTASTE ESTA COMPRA</h4></li>
			        <li class="collection-item">Espera que la tienda responda tu mensaje</li>
			        <li class="collection-item">Mensaje a tienda: {{reportado.Rep_Comentario}}</li>
			    </ul>
			{% else %}				
			<ul class="collection">
			{% for re1 in reporte1 %}
					<li class="collection-item grey lighten-4">
						<p>
					      <input name="reporte" type="radio" id="re1{{re1.Id_R1}}" value="{{re1.Id_R1}}" />
					      <label for="re1{{re1.Id_R1}}">{{re1.R1}}</label>
					    </p>
					</li>
					<li class="collection-item hide" id="sel{{re1.Id_R1}}">
						<ul>		
							{% for re2 in reporte2 %}
								{% if re1.Id_R1 == re2.Id_R1 %}	
								<li class="collection-item">
									<p>
								      <input name="reporte2" type="radio" id="re2{{re2.Id_R2}}" value="{{re2.Id_R2}}" />
								      <label for="re2{{re2.Id_R2}}">{{re2.R2}}</label>
								    </p>
								</li>
								<li class="collection-item hide" id="sel2{{re2.Id_R2}}">
									<ul>
									{% for re3 in reporte3 %}
										{% if re2.Id_R2 == re3.Id_R2 %}							
										<li class="collection-item">
											<p>
										      <input name="reporte3" type="radio" id="re3{{re3.Id_R3}}" value="{{re3.Id_R3}}" />
										      <label for="re3{{re3.Id_R3}}">{{re3.R3}}</label>
										    </p>
										</li>
											<li class="collection-item hide" id="sel3{{re3.Id_R3}}">
												<ul>
												{% for re4 in reporte4 %}
													{% if re3.Id_R3 == re4.Id_R3 %}	
													<li class="collection-item">
														<p>
													      <input name="reporte4" type="radio" id="re4{{re4.Id_R4}}" value="{{re4.Id_R4}}" />
													      <label for="re4{{re4.Id_R4}}">{{re4.R4}}</label>
													    </p>
													</li>
													{% endif %}
												{% endfor %}
												</ul>
											</li>
											{% endif %}
										{% endfor %}
										</ul>
									</li>
									{% endif %}
								{% endfor %}
								</ul>
							</li>
						{% endfor %}
					</ul>
					<div class="input-field msjReclamo">
						<textarea  class="materialize-textarea" id="msjReclamo"></textarea>
          				<label for="msjReclamo">Escribe un mensaje a la tienda</label>
					</div>
					<div class="center">
						<a class="btn enviarReclamo" data-idtie="{{idtienda}}" data-idven="{{idventa}}" data-usu="{{idusuario}}">Enviar mensaje a tienda</a>
					</div>
					
				{% endif %}
          </div>
		</div>
    </main>
{% endblock %}

{% block script %}
    <script language="JavaScript" type="text/javascript" src="{{base_url('public/intranet/js/jquery-confirm.min.js')}}"></script>
    <script src="{{base_url('public/intranet/js/')}}please-wait.min.js" type="text/javascript"></script>
    <script type="text/javascript">
		  $(document).ready(function(){

	     	$('input[name=reporte]').click(function(){
	     		var val = $(this).val();
	     		if(val == 1){
     				$('#sel1').removeClass('hide');
     				$('#sel2').addClass('hide');
	     		}else{
     				$('#sel2').removeClass('hide');
     				$('#sel1').addClass('hide');
	     		}	
	     	});

	     	$('input[name=reporte2]').click(function(){
	     		var val = $(this).val();
	     		if(val == 1){
     				$('#sel21').removeClass('hide');
     				$('#sel22').addClass('hide');
     				$('#sel23').addClass('hide');
	     		}else if(val == 2){
	     			$('#sel21').addClass('hide');
     				$('#sel22').removeClass('hide');
     				$('#sel23').addClass('hide');
	     		}else if(val == 3){
     				$('#sel21').addClass('hide');
     				$('#sel22').addClass('hide');
     				$('#sel23').removeClass('hide');
	     		}	   
	     	});


	     	$('input[name=reporte3]').click(function(){
	     		var val = $(this).val();

	     		if(val == 1){
     				$('#sel31').removeClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}else if(val == 2){
	     			$('#sel31').addClass('hide');
     				$('#sel32').removeClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}else if(val == 3){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').removeClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');	
	     		}else if(val == 4){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').removeClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 5){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').removeClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 6){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').removeClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 7){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').removeClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 8){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').removeClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 9){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').removeClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 10){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').removeClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 11){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').removeClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 12){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').removeClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 13){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').removeClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 14){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').removeClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 15){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').removeClass('hide');
     				$('#sel316').addClass('hide');
	     		}	else if(val == 16){
     				$('#sel31').addClass('hide');
     				$('#sel32').addClass('hide');
     				$('#sel33').addClass('hide');
     				$('#sel34').addClass('hide');
     				$('#sel35').addClass('hide');
     				$('#sel36').addClass('hide');
     				$('#sel37').addClass('hide');
     				$('#sel38').addClass('hide');
     				$('#sel39').addClass('hide');
     				$('#sel310').addClass('hide');
     				$('#sel311').addClass('hide');
     				$('#sel312').addClass('hide');
     				$('#sel313').addClass('hide');
     				$('#sel314').addClass('hide');
     				$('#sel315').addClass('hide');
     				$('#sel316').removeClass('hide');
	     		}	   
	     	});



		     $('.enviarReclamo').click(function(){

		     	var r1 = $('input[name=reporte]:checked').val();
		     	var r2 = $('input[name=reporte2]:checked').val();
		     	var r3 = $('input[name=reporte3]:checked').val();
		     	var r4 = $('input[name=reporte4]:checked').val();
		     	var comentario = $('#msjReclamo').val();
		     	var idVenta = $(this).data('idven');
		     	var idTienda = $(this).data('idtie');
		     	var idUsuario = $(this).data('usu');

		     	if(r4 == undefined){
		     		r4 = 0;
		     	}

		     	console.log("R1:"+r1+"R2:"+r2+"R3:"+r3+"R4:"+r4+"comentario:"+comentario);

		     	if(r1 && r2 && r3 && comentario){
		     		$.ajax({
				        data:{
				          'r1' : r1,
				          'r2' : r2,
                              'r3' : r3,
				          'r4' : r4,
				          'idVenta' : idVenta,
				          'idTienda' : idTienda,
				          'idUsuario' : idUsuario,
				          'comentario' : comentario
				          },
				        type: "POST",
				        url: base_url+'comprador/compra/reportar_compra_tienda', 
				        dataType: "json",
				        success: function(data){
				          if(data){
				            $.confirm({
				              icon: 'email',
				              theme: 'modern',
				              closeIcon: false,
				              animationBounce: 1.5,
				              autoClose: 'Aceptar|3000',
				              type: 'green',
				              title: 'Reclamo guardado exitosamente',
				              columnClass: 'small',
				              content: 'PorMayor.pe te enviara todos los datos del dueño de tienda para que lleguen a un acuerdo.',
				              draggable: false,
				              buttons: {
				                Aceptar: {
				                  btnClass: 'btn',
				                  action: function (){
				                    window.location.href = base_url+'comprador/compra/detalle/'+idVenta;
				                  }
				                }
				              }
				            });
				          }
				          else{
				            Materialize.toast('<i class="material-icons left ">warning</i>Ocurrió un error', 2000, 'rounded warningToast');
				          }
				          
				        }
				     });

		     	}else{
		     		Materialize.toast('Selecciona una opción y dejanos tu comentario', 2000);
		     	}


		     });


		  });
    </script>
{% endblock %}
